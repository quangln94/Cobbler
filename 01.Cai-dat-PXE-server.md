# PXE Server
## 1. Cài đặt PXE-Server trên CentOS8
### 1.1. Cài đặt TFTP 
```sh
dnf -y install tftp-server
systemctl enable --now tftp.socket
```
### 1.2 Cài đặt và cấu hình DHCP server
**Cài đặt DHCP-Server**
```sh
dnf -y install dhcp-server
```
**Cấu hình DHCP-Server**
```sh
$ vim /etc/dhcp/dhcpd.conf

option domain-name     "srv.world";
option domain-name-servers     dlp.srv.world;
default-lease-time 600;
max-lease-time 7200;
authoritative;

option space pxelinux;
option pxelinux.magic code 208 = string;
option pxelinux.configfile code 209 = text;
option pxelinux.pathprefix code 210 = text;
option pxelinux.reboottime code 211 = unsigned integer 32;
option architecture-type code 93 = unsigned integer 16;

subnet 10.0.0.0 netmask 255.255.255.0 {
    range dynamic-bootp 10.0.0.200 10.0.0.254;
    option broadcast-address 10.0.0.255;
    option routers 10.0.0.1;
    # add follows
    class "pxeclients" {
        match if substring (option vendor-class-identifier, 0, 9) = "PXEClient";
        # PXE servers hostname or IP address
        next-server dlp.srv.world;

        if option architecture-type = 00:07 {
            filename "BOOTX64.EFI";
        }
        else {
            filename "pxelinux.0";
        }
    }
}
```
**Enable DHCP-Server**
```sh
systemctl enable --now dhcpd
```
### 1.3. Tải file iso cài đặt cho CentOS8
```sh
wget http://mirrors.viethosting.com/centos/8.2.2004/isos/x86_64/CentOS-8.2.2004-x86_64-minimal.iso
```
### 1.4. Tạo thư mục cho PXE booting
```sh
mkdir /var/lib/tftpboot/pxelinux.cfg
```
**Tạo file cấu hình**
```sh
default vesamenu.c32
prompt 1
timeout 60

display boot.msg

label linux
  menu label ^Install CentOS 8
  menu default
  kernel centos8/vmlinuz
  append initrd=centos8/initrd.img ip=dhcp inst.repo=http://10.0.0.30/centos8
label vesa
  menu label Install CentOS 8 with ^basic video driver
  kernel centos8/vmlinuz
  append initrd=centos8/initrd.img ip=dhcp inst.xdriver=vesa nomodeset inst.repo=http://10.0.0.30/centos8
label rescue
  menu label ^Rescue installed system
  kernel centos8/vmlinuz
  append initrd=centos8/initrd.img rescue
label local
  menu label Boot from ^local drive
  localboot 0xffff
```
